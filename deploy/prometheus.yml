global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'limpeza-pro-prod'

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets: []

# Rule files
rule_files:
  - "alert_rules.yml"

scrape_configs:
  # ============================================================
  # Prometheus Self-monitoring
  # ============================================================
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # ============================================================
  # Backend API Metrics
  # ============================================================
  - job_name: 'backend'
    static_configs:
      - targets: ['backend:3001']
    metrics_path: '/api/metrics'
    scrape_interval: 5s
    scrape_timeout: 5s

  # ============================================================
  # PostgreSQL Metrics
  # ============================================================
  - job_name: 'postgres'
    static_configs:
      - targets: ['postgres:5432']
    metrics_path: '/metrics'
    # Usar postgres_exporter em produção:
    # docker run -d --name postgres_exporter \
    #   -e DATA_SOURCE_NAME="postgresql://user:pass@postgres:5432/db" \
    #   -p 9187:9187 prometheuscommunity/postgres-exporter

  # ============================================================
  # Redis Metrics
  # ============================================================
  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']
    metrics_path: '/metrics'
    # Usar redis_exporter em produção:
    # docker run -d --name redis_exporter \
    #   -p 9121:9121 oliver006/redis_exporter \
    #   --redis-addr redis:6379 --redis-password password

  # ============================================================
  # Docker Daemon Metrics
  # ============================================================
  - job_name: 'docker'
    static_configs:
      - targets: ['localhost:8080']
    # Requer: docker run -d --name cadvisor -p 8080:8080 gcr.io/cadvisor/cadvisor:latest

  # ============================================================
  # Node (System) Metrics
  # ============================================================
  - job_name: 'node'
    static_configs:
      - targets: ['localhost:9100']
    # Requer: docker run -d --name node_exporter \
    #   -p 9100:9100 \
    #   prom/node-exporter:latest
